== Android ==

1. mkdir aosp; cd aosp
2. Install repo as per https://source.android.com/setup/build/downloading
3. repo init -u https://android.googlesource.com/platform/manifest -b android-9.0.0_r10
4. git clone https://gitlab.collabora.com/zodiac/android_manifest.git .repo/local_manifests/
5. repo sync -j8
6. . build/envsetup.sh
7. lunch spurv-eng
8. make -j12

== Kernel ==

1. git clone https://kernel.googlesource.com/pub/scm/linux/kernel/git/torvalds/linux
2. cd linux
3. git reset --hard v4.20
4. sh ../aosp/device/freedesktop/spurv/build-kernel.sh
5. The kernel image is at arch/arm/boot/zImage and the DT at arch/arm/boot/dts/imx6qp-zii-rdu2.dtb

== Root filesystem ==

1. sudo apt install debootstrap qemu-user-static
2. sudo debootstrap --include=systemd,weston,systemd-container,udev,sudo,openssh-server,iputils-ping,pulseaudio --arch armhf --variant minbase testing rootfs http://deb.debian.org/debian/
3. sudo chroot rootfs adduser aosp --ingroup sudo
4. cp linux/arch/arm/boot/zImage linux/arch/arm/boot/dts/imx6qp-zii-rdu2.dtb rootfs/boot/.
5. sudo cp -rfa rootfs/* /mnt/sdcard/.
6. cp aosp/device/freedesktop/spurv/run.sh rootfs/home/aosp/.
7. cp aosp/device/freedesktop/spurv/system.img rootfs/home/aosp/aosp.img
8. cp aosp/device/freedesktop/spurv/vendor.img rootfs/home/aosp/.
9. cp aosp/device/freedesktop/spurv/userdata.img rootfs/home/aosp/.

== Boot SD card ==

1. In barebox's console:
2. detect mmc1
3. global.linux.bootargs.base="console=ttymxc0,115200 console=tty0 enforcing=0 ip=dhcp rw rootwait root=/dev/mmcblk0 log_buf_len=16M cma=512M vmalloc=512M" 
4. bootm -o /mnt/mmc1/boot/imx6qp-zii-rdu2.dtb -r /mnt/mmc1/boot/initramfs.uImage /mnt/mmc1/boot/zImage

== Run! ==

1. Log as aosp
2. sh run.sh
